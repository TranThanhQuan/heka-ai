import{k as _,h as w,b as k,o as v,a as x,e as t,u as r,Z as y,g as m,d as S,t as P,F as U}from"./app-CPuNsaQu.js";import{e as A}from"./tracking-cM1pk6uz.js";import{g as C,u as L}from"./auth-BRbl7ls7.js";import{_ as M}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./helpers-BIkqR0Wr.js";const N={class:"min-h-screen flex items-center justify-center bg-[#e2ebfb]"},T={class:"text-center px-4 py-8 sm:px-6 sm:py-10 max-w-md w-11/12"},B={class:"text-base sm:text-lg text-left mb-6 space-y-2"},H={key:0,id:"email"},R={class:"text-black break-all"},V=["href"],D={__name:"Success",props:{sessionId:String},setup(E){let c=_(""),s=_(""),g=localStorage.getItem("checkoutId");localStorage.removeItem("checkoutId"),localStorage.getItem("payment_redirect_from"),localStorage.removeItem("payment_redirect_from");const u=new URLSearchParams(window.location.search).get("id"),p=localStorage.getItem("accessToken");if(!u||!g||u!==g)window.location.href="/";else{p&&C();const e=new URLSearchParams(window.location.search).get("session_id");if(e){const i=`https://api-heka.dev.apero.vn/api/v1/payment/verify-checkout-session?session_id=${e}`;$.ajax({url:i,method:"GET",success:function(a){console.log("✅ Dữ liệu trả về từ API:",a)},error:function(a,j,I){console.error("❌ Lỗi khi gọi API:",I),a.responseJSON&&console.error("Chi tiết lỗi:",a.responseJSON)}})}else console.warn("⚠️ Không tìm thấy session_id trong URL.");const h=parseInt(localStorage.getItem("checkoutCount"))||0;localStorage.setItem("checkoutCount",h+1);const b=localStorage.getItem("package_id");localStorage.removeItem("package_id");const l=localStorage.getItem("goal");let n="";l==="lose"?n="onboarding_lose":l==="maintain"?n="onboarding_maintain":l==="gain"?n="onboarding_gain":l==="healthy"?n="onboarding_healthy":n="home_scr_pro_icon",A("iap_successfull",{convert_number:h+1,purchase_package_id:b,source:n});const f=["activity","goal","gender","year_of_birth","measure_type","current_weight","current_height","target_cal","goal_weight","start_date","end_date"],d={};f.forEach(i=>{const a=localStorage.getItem(i);a!==null&&a!==""&&(d[i]=a)}),f.every(i=>i in d)&&p&&L(d)}return c.value=localStorage.getItem("email"),w(()=>{if(result)s.value=result.clickURL;else{const o=navigator.userAgent;if(o.includes("iPhone")||o.includes("iPad")||o.includes("iPod"))s.value="https://apps.apple.com/app/heka-ai-calorie-counter/id6747111547";else if(o.includes("Android"))s.value="https://play.google.com/store/apps/details?id=com.heka.ai.caloriecounter.mealplan&hl=en";else{const e=(void 0).split(",");o.includes("iPhone")||o.includes("iPad")||o.includes("iPod")||o.includes("Android"),s.value=e[Math.floor(Math.random()*e.length)]}}}),(o,e)=>(v(),k(U,null,[x(r(y),{title:"Subscription Activated"}),t("div",N,[t("div",T,[e[3]||(e[3]=t("h4",{class:"text-lg sm:text-xl font-bold mb-4"},[m(" Thanks for being amazing with Heka AI."),t("br"),m(" Let's start your plan now! ")],-1)),e[4]||(e[4]=t("a",{href:"/"},[t("img",{src:"/images/icon.png",alt:"Heka Logo",class:"w-20 h-20 mx-auto my-4"})],-1)),t("ol",B,[e[1]||(e[1]=t("li",null,"1. Click on the link below to download Heka AI",-1)),e[2]||(e[2]=t("li",null,'2. Open the app and select "Sign in"',-1)),r(c)?(v(),k("li",H,[e[0]||(e[0]=m(" 3. Use your sign-up email: ")),t("strong",R,P(r(c)),1)])):S("",!0)]),t("a",{href:r(s),class:"block w-full bg-indigo-600 text-white font-semibold text-sm py-2.5 rounded-lg hover:bg-indigo-700 transition duration-200"}," Download Heka ",8,V),e[5]||(e[5]=t("a",{href:"/",class:"text-indigo-600 text-sm hover:text-indigo-800 block mt-3"},"Back to home",-1))])])],64))}},Z=M(D,[["__scopeId","data-v-4c725b24"]]);export{Z as default};
